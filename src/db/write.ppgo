import (
    "../proto";
)

public interface CmdWriteProc
{
    public func do_write(client proto.Client, vs VSlot);
}

public func do_write(client proto.Client, cwp CmdWriteProc, hash_tag string)
{
    var id = hash_tag_to_vslot_id(hash_tag);
    with (vslot_write_locks[id])
    {
        var vs = VSlot(id, read_only = false);
        cwp.do_write(client, vs);
        get_db(id).write(vs.snapshot.export_wb());
    }
}
